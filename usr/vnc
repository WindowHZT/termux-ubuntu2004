#!/bin/bash
#字体颜色
red="\e[31;1m"      #红
green="\e[32;1m"   #绿
yellow="\e[33;1m"  #黄
blue="\e[34;1m"    #蓝
purple="\e[35;1m"    #紫红
cyanine="\e[36;1m"    #青蓝
white="\e[0m"

CONFIG=/usr/local/bin/.config

msg() { clear;echo -e "\n\t\t$blue[*]$white$1$2$white\n" ;:;}  ##自定义通告颜色




_login(){
	i=0
	str=""
	label=('|' '/' '-' '\\')
	index=0
	while [ $i -le 20 ]
	do
		let index=i%4
		let jinshu=$i*5
		printf "\e[0m\e[32m[%-20s]\e[0m\e[0;32m[%c]\e[1;0m\e[0;35m[%-3d%%]\e[1;0m\r" $str ${label[$index]} $jinshu
		let i++
		str+="#"
		sleep 0.1
	done
	echo
}


_start(){
	clear
	[ ! -e "/data/data/com.termux/files/home/storage/shared/swap" ]&&mkdir /data/data/com.termux/files/home/storage/shared/swap
	[ ! -e "`echo ~/Desktop/MTS`" ]&&mkdir ~/Desktop/MTS
	[ ! -L "`echo ~/Desktop/MTS/swap`" ]&&ln -s /data/data/com.termux/files/home/storage/shared/swap ~/Desktop/MTS
	[ ! -L "`echo ~/Desktop/MTS/Download`" ]&&ln -s /data/data/com.termux/files/home/storage/shared/Download ~/Desktop/MTS
	#[ ! -L "`echo ~/Desktop/MTS/QQfile_recv`" ]&&ln -s /data/data/com.termux/files/home/storage/shared/Android/data/com.tencent.mobileqq/Tencent/QQfile_recv ~/Desktop/MTS
	if [ ! -e "`echo ~/Desktop/MTS/说明.txt`" ];then
		touch ~/Desktop/MTS/说明.txt
		cat <<-EOF >~/Desktop/MTS/说明.txt
		|************************|
		PS：1.这个MTS目录是连接到手机存储目录的交换区。
			 2.方便非Root用户存取文件，和交换文件。
			 3.每一次开机都会自动创建这个目录，不用担心它被删除。
			 
		使用方法：step1.在你手机自带的文件管理器找到 MTS 这个目录。
				   step2.把你下载的刘德华最新歌曲mp3文件，复制一份到这个目录。
				   step3.打开你的ubuntu系统，在桌面点击 MTS 目录就可以看见你的mp3歌曲了。
				   
		注意：同样的，你也可以把ubuntu里面的办公文件移动到 MTS 这个目录，然后去你手机文
			  件管理器就可以轻松获取到你的办公文件了
			  
		优点：解决了虚拟机与物理机文件交换繁杂的问题。
		待改进：解除安卓11系统限制访问data文件夹
		
		|************************|
		关于输入法说明：
				1）切换中/英 快捷键是 Ctrl+空格
		
		
		手机QQ接收的文件在下面这个目录
		/storage/emulated/0/Android/data/com.tencent.mobileqq/Tencent/QQfile_recv/
		EOF
	fi
	
	echo -e "\n$red ubuntu启动ing…默认密码为$green$USER$red的帐号密码$white"
	sudo echo 
	sudo service dbus restart
	sudo service dbus stop
	sudo dbus-daemon --system
	sudo service dbus status 
	
	##启动tigervnc 
	vncserver -kill :1  > /dev/null 2>&1
	source $CONFIG
	LD_PRELOAD=/lib/aarch64-linux-gnu/libgcc_s.so.1 vncserver -localhost no -depth 24 -name remote-desktop $GEO :$PORT
	
	##启动xrdp
	if [ ! -z "$(command -v xrdp)" ];then
		xrdp -k
		rm -rf /var/run/xrdp/xrdp-sesman.pid
		rm -rf /var/run/xrdp/xrdp.pid
		sudo service xrdp restart
		sleep 0.9
		sudo service xrdp status
	fi
	
	service --status-all
	_login
	msg $green "ubuntu20.04开机完毕·欢迎~"
	echo -e "\t$red获取更多帮助请使用命令 ubuntu$white"
}


_stop(){
	USER=$(whoami)
	msg $red "VNC服务列表如下："
	vncserver -list
	echo -n "输入需要杀死的端口号(示例:3):"
	read pt
	echo " "
	echo "已杀死的端口 $pt"
	vncserver -kill :$pt
	rm -rf /tmp/.X$pt-lock
	rm -rf /tmp/.X11-unix/X$pt
}


_PWD(){
	read -sp '请提供一个新的VNC密码: ' PASSWORD
	vncpasswd -f <<<"$PASSWORD\n$PASSWORD" > $HOME/.vnc/passwd
	msg $green "VNC登录密码已修改！"
}




_DPI(){
	export USER=$(whoami)
	export LC_ALL="zh_CN.UTF-8"
	HEIGHT=0
	WIDTH=0
	CHOICE_HEIGHT=5
	BACKTITLE="VNC 分辨率选择"
	TITLE="vncserver-start"
	MENU="请选择你的分辨率"
	export PORT=1
	
	OPTIONS=(
         1 "QHD 2k画质(2560x1600)"
         2 "FHD 1080p画质(1920x1080)"
         3 "HD-ready 高清画质(1280x720)"
         4 "自动画质"
         5 "自定义画质/端口")

	CHOICE=$(dialog --clear \
                --backtitle "$BACKTITLE" \
                --title "$TITLE" \
                --menu "$MENU" \
                $HEIGHT $WIDTH $CHOICE_HEIGHT \
                "${OPTIONS[@]}" \
                2>&1 >/dev/tty)

	clear
	case $CHOICE in
        1)
            echo "你选择了QHD 2k画质(2560x1600)"
            sed -i "s#`cat $CONFIG | grep "GEO=" |awk -F '"' '{print $2}'`#-geometry 2560x1600#g" $CONFIG
            ;;
        2)
            echo "你选择了FHD 1080p画质(1920x1080)"
            sed -i "s#`cat $CONFIG | grep "GEO=" |awk -F '"' '{print $2}'`#-geometry 1920x1080#g" $CONFIG
            ;;
        3)
            echo "你选择了HD-ready 高清画质(1280x720)"
            sed -i "s#`cat $CONFIG | grep "GEO=" |awk -F '"' '{print $2}'`#-geometry 1280x720#g" $CONFIG
            ;;
        4)
            echo "你选择了自动画质"
			sed -i "s#`cat $CONFIG | grep "GEO=" |awk -F '"' '{print $2}'`##g" $CONFIG
            ;;
        5)
            echo "您选择手动提供 分辨率/端口"
            echo "输入您的自定义分辨率格式WIDTHxHEIGHT即1920x1200"
            echo -ne "分辨率：" ""
            read custom
            echo "输入您的自定义端口，即2" 
            echo -ne "端口：" ""
            read port
            sed -i "s#`cat $CONFIG | grep "GEO=" |awk -F '"' '{print $2}'`#-geometry $custom#g" $CONFIG
            #echo "GEO=\"-geometry $custom\"" > $CONFIG
            #echo "PORT=$port" >> $CONFIG
            sed -i "s#`cat $CONFIG | grep "PORT="`#PORT=$port#g" $CONFIG
            ;;
	esac	
}

_xfce(){
	[ ! -e $CONFIG ]&&touch $CONFIG
    echo 'GEO="-geometry 2560x1600"' >> $CONFIG
    echo 'PORT=1' >> $CONFIG

	msg $red "安装xfce桌面"
	echo -e "$red请输入root用户的密码：$white"
	sudo apt purge dialog -y

	sudo  apt install eatmydata -y
	sudo eatmydata apt install software-properties-common -y
	sudo add-apt-repository ppa:xubuntu-dev/staging -y
	sudo apt-get update
	
	sudo eatmydata apt install keyboard-configuration -y
	sudo eatmydata apt install tzdata -y
	sudo eatmydata apt install sudo wget nano inetutils-tools dialog bc dbus-x11 -y 
	sudo eatmydata apt install xfce4 xfce4-goodies xfce4-terminal exo-utils tigervnc-standalone-server tigervnc-common  ffmpeg  language-pack-en --no-install-recommends -y
	sudo eatmydata apt clean git -y
	
	mkdir -p ~/.vnc
	USER=`cat /usr/local/bin/.USER`
	LD_PRELOAD=/lib/aarch64-linux-gnu/libgcc_s.so.1 vncpasswd -f <<< `cat /usr/local/bin/.PASSWORD` > "/home/$USER/.vnc/passwd"
	rm -rf /usr/local/bin/.PASSWORD

	#/usr/bin/vncpasswd -f <<<"$PASSWORD\n$PASSWORD" > "/home/$USER/.vnc/passwd"
	#vncpasswd -f <<<"$PASSWORD"$'\n'"$PASSWORD" > /root/.vnc/passwd 

	cat <<-EOF > ~/.vnc/xstartup
	#!/bin/bash
	[ -r \$HOME/.Xresources ] && xrdb \$HOME/.Xresources
	export PULSE_SERVER=127.0.0.1
	XAUTHORITY=\$HOME/.Xauthority
	export XAUTHORITY
	#LANG=en_US.UTF-8
	#export LANG
	echo \$\$ > /tmp/xsession.pid
	dbus-launch --exit-with-session startxfce4 &
	EOF
	
	sudo eatmydata apt install fonts-wqy-microhei  libglu1-mesa bsdmainutils xdg-utils libxslt-dev libxml2-dev python3-pyqt5 ttf-mscorefonts-installer -y  # language-selector-gnome at-spi2-core 
	
	##安装fcitx
	sudo eatmydata apt purge ibus -y
	sudo eatmydata apt install fcitx fcitx-ui-qimpanel -y
	sudo eatmydata apt install fcitx-bin -y
	sudo eatmydata apt install fcitx-table -y
	sudo eatmydata apt install fcitx-pinyin -y
	#sudo eatmydata apt remove fcitx-ui-classic -y
	im-config fcitx
	sudo cp /usr/share/fcitx/xdg/autostart/fcitx-autostart.desktop /etc/xdg/autostart/

	echo "export DISPLAY=\":1\"" >> /etc/profile
	source /etc/profile
	
	[ -z "`dpkg -l | grep fonts-wqy-microhei`" ]&&sudo apt-get install fonts-wqy-microhei -y
	[ ! -z "`cat /etc/locale.gen|grep '# zh_CN.UTF-8 UTF-8'`" ]&&sed -i "s/# zh_CN.UTF-8 UTF-8/ zh_CN.UTF-8 UTF-8/g" /etc/locale.gen
	locale-gen
	echo "export LC_ALL=zh_CN.UTF-8" >> ~/.bashrc
	
	cat <<-EOF>> /etc/environment
	TMOE_PROOT=true
	MOZ_FAKE_NO_SANDBOX=1
	QT_QPA_PLATFORMTHEME=qt5ct
	SDL_IM_MODULE="fcitx"
	XMODIFIERS="@im=fcitx"
	QT_IM_MODULE="fcitx"
	GTK_IM_MODULE="fcitx"
	EOF
	row=`cat ~/.config/fcitx/profile | grep -n EnabledIMList | awk -F ":" '{print $1}'`
	sed -i "$row"d ~/.config/fcitx/profile
	sed -i "17"d ~/.config/fcitx/profile
	sed -i '/# Current Enabled Input Method List/a\EnabledIMList=pinyin:True,fcitx-keyboard-us:True,shuangpin:True,fcitx-keyboard-af:False,fcitx-keyboard-af-fa-olpc:False,fcitx-keyboard-af-olpc-ps:False,fcitx-keyboard-af-ps:False,fcitx-keyboard-af-uz:False,fcitx-keyboard-af-uz-olpc:False,fcitx-keyboard-al:False,fcitx-keyboard-al-plisi:False,fcitx-keyboard-al-veqilharxhi:False,fcitx-keyboard-am:False,fcitx-keyboard-am-eastern:False,fcitx-keyboard-am-eastern-alt:False,fcitx-keyboard-am-olpc-phonetic:False,fcitx-keyboard-am-phonetic:False,fcitx-keyboard-am-phonetic-alt:False,fcitx-keyboard-am-western:False,fcitx-keyboard-apl:False,fcitx-keyboard-apl-apl2:False,fcitx-keyboard-apl-aplplusII:False,fcitx-keyboard-apl-aplx:False,fcitx-keyboard-apl-dyalog:False,fcitx-keyboard-apl-sax:False,fcitx-keyboard-apl-unified:False,fcitx-keyboard-ara:False,fcitx-keyboard-ara-azerty:False,fcitx-keyboard-ara-azerty_digits:False,fcitx-keyboard-ara-basic_ext:False,fcitx-keyboard-ara-basic_ext_digits:False,fcitx-keyboard-ara-buckwalter:False,fcitx-keyboard-ara-digits:False,fcitx-keyboard-ara-mac:False,fcitx-keyboard-ara-olpc:False,fcitx-keyboard-ara-qwerty:False,fcitx-keyboard-ara-qwerty_digits:False,fcitx-keyboard-ara-sun_type6:False,fcitx-keyboard-ara-uga:False,fcitx-keyboard-at:False,fcitx-keyboard-at-mac:False,fcitx-keyboard-at-nodeadkeys:False,fcitx-keyboard-at-sundeadkeys:False,fcitx-keyboard-au:False,fcitx-keyboard-az:False,fcitx-keyboard-az-cyrillic:False,fcitx-keyboard-ba:False,fcitx-keyboard-ba-alternatequotes:False,fcitx-keyboard-ba-unicode:False,fcitx-keyboard-ba-unicodeus:False,fcitx-keyboard-ba-us:False,fcitx-keyboard-bd:False,fcitx-keyboard-bd-probhat:False,fcitx-keyboard-be:False,fcitx-keyboard-be-iso-alternate:False,fcitx-keyboard-be-nodeadkeys:False,fcitx-keyboard-be-oss:False,fcitx-keyboard-be-oss_latin9:False,fcitx-keyboard-be-oss_sundeadkeys:False,fcitx-keyboard-be-sun_type6:False,fcitx-keyboard-be-sundeadkeys:False,fcitx-keyboard-be-wang:False,fcitx-keyboard-bg:False,fcitx-keyboard-bg-bas_phonetic:False,fcitx-keyboard-bg-phonetic:False,fcitx-keyboard-br:False,fcitx-keyboard-br-dvorak:False,fcitx-keyboard-br-nativo:False,fcitx-keyboard-br-nativo-epo:False,fcitx-keyboard-br-nativo-us:False,fcitx-keyboard-br-nodeadkeys:False,fcitx-keyboard-br-sun_type6:False,fcitx-keyboard-br-thinkpad:False,fcitx-keyboard-brai:False,fcitx-keyboard-brai-left_hand:False,fcitx-keyboard-brai-left_hand_invert:False,fcitx-keyboard-brai-right_hand:False,fcitx-keyboard-brai-right_hand_invert:False,fcitx-keyboard-bt:False,fcitx-keyboard-bw:False,fcitx-keyboard-by:False,fcitx-keyboard-by-latin:False,fcitx-keyboard-by-legacy:False,fcitx-keyboard-ca:False,fcitx-keyboard-ca-eng:False,fcitx-keyboard-ca-fr-dvorak:False,fcitx-keyboard-ca-fr-legacy:False,fcitx-keyboard-ca-ike:False,fcitx-keyboard-ca-kut:False,fcitx-keyboard-ca-multi:False,fcitx-keyboard-ca-multi-2gr:False,fcitx-keyboard-ca-multix:False,fcitx-keyboard-ca-shs:False,fcitx-keyboard-ca-sun_type6:False,fcitx-keyboard-cd:False,fcitx-keyboard-ch:False,fcitx-keyboard-ch-de_mac:False,fcitx-keyboard-ch-de_nodeadkeys:False,fcitx-keyboard-ch-de_sundeadkeys:False,fcitx-keyboard-ch-fr:False,fcitx-keyboard-ch-fr_mac:False,fcitx-keyboard-ch-fr_nodeadkeys:False,fcitx-keyboard-ch-fr_sundeadkeys:False,fcitx-keyboard-ch-legacy:False,fcitx-keyboard-ch-sun_type6_de:False,fcitx-keyboard-ch-sun_type6_fr:False,fcitx-keyboard-cm:False,fcitx-keyboard-cm-azerty:False,fcitx-keyboard-cm-dvorak:False,fcitx-keyboard-cm-french:False,fcitx-keyboard-cm-mmuock:False,fcitx-keyboard-cm-qwerty:False,fcitx-keyboard-cn:False,fcitx-keyboard-cn-altgr-pinyin:False,fcitx-keyboard-cn-mon_manchu_galik:False,fcitx-keyboard-cn-mon_todo_galik:False,fcitx-keyboard-cn-mon_trad:False,fcitx-keyboard-cn-mon_trad_galik:False,fcitx-keyboard-cn-mon_trad_manchu:False,fcitx-keyboard-cn-mon_trad_todo:False,fcitx-keyboard-cn-mon_trad_xibe:False,fcitx-keyboard-cn-tib:False,fcitx-keyboard-cn-tib_asciinum:False,fcitx-keyboard-cn-ug:False,fcitx-keyboard-cz:False,fcitx-keyboard-cz-bksl:False,fcitx-keyboard-cz-coder:False,fcitx-keyboard-cz-dvorak-ucw:False,fcitx-keyboard-cz-prog:False,fcitx-keyboard-cz-prog_typo:False,fcitx-keyboard-cz-qwerty:False,fcitx-keyboard-cz-qwerty-mac:False,fcitx-keyboard-cz-qwerty_bksl:False,fcitx-keyboard-cz-rus:False,fcitx-keyboard-cz-sun_type6:False,fcitx-keyboard-cz-typo:False,fcitx-keyboard-cz-ucw:False,fcitx-keyboard-de:False,fcitx-keyboard-de-T3:False,fcitx-keyboard-de-adnw:False,fcitx-keyboard-de-bone:False,fcitx-keyboard-de-bone_eszett_home:False,fcitx-keyboard-de-deadacute:False,fcitx-keyboard-de-deadgraveacute:False,fcitx-keyboard-de-deadtilde:False,fcitx-keyboard-de-dsb:False,fcitx-keyboard-de-dsb_qwertz:False,fcitx-keyboard-de-dvorak:False,fcitx-keyboard-de-hu:False,fcitx-keyboard-de-koy:False,fcitx-keyboard-de-lld:False,fcitx-keyboard-de-mac:False,fcitx-keyboard-de-mac_nodeadkeys:False,fcitx-keyboard-de-neo:False,fcitx-keyboard-de-neo_qwerty:False,fcitx-keyboard-de-neo_qwertz:False,fcitx-keyboard-de-nodeadkeys:False,fcitx-keyboard-de-pl:False,fcitx-keyboard-de-qwerty:False,fcitx-keyboard-de-ro:False,fcitx-keyboard-de-ro_nodeadkeys:False,fcitx-keyboard-de-ru:False,fcitx-keyboard-de-ru-recom:False,fcitx-keyboard-de-ru-translit:False,fcitx-keyboard-de-sun_type6:False,fcitx-keyboard-de-sundeadkeys:False,fcitx-keyboard-de-tr:False,fcitx-keyboard-de-us:False,fcitx-keyboard-dk:False,fcitx-keyboard-dk-dvorak:False,fcitx-keyboard-dk-mac:False,fcitx-keyboard-dk-mac_nodeadkeys:False,fcitx-keyboard-dk-nodeadkeys:False,fcitx-keyboard-dk-sun_type6:False,fcitx-keyboard-dk-winkeys:False,fcitx-keyboard-dz:False,fcitx-keyboard-dz-ar:False,fcitx-keyboard-dz-ber:False,fcitx-keyboard-ee:False,fcitx-keyboard-ee-dvorak:False,fcitx-keyboard-ee-nodeadkeys:False,fcitx-keyboard-ee-sun_type6:False,fcitx-keyboard-ee-us:False,fcitx-keyboard-epo:False,fcitx-keyboard-epo-legacy:False,fcitx-keyboard-es:False,fcitx-keyboard-es-ast:False,fcitx-keyboard-es-cat:False,fcitx-keyboard-es-deadtilde:False,fcitx-keyboard-es-dvorak:False,fcitx-keyboard-es-mac:False,fcitx-keyboard-es-nodeadkeys:False,fcitx-keyboard-es-sun_type6:False,fcitx-keyboard-es-sundeadkeys:False,fcitx-keyboard-es-winkeys:False,fcitx-keyboard-et:False,fcitx-keyboard-eu:False,fcitx-keyboard-fi:False,fcitx-keyboard-fi-classic:False,fcitx-keyboard-fi-das:False,fcitx-keyboard-fi-fidvorak:False,fcitx-keyboard-fi-mac:False,fcitx-keyboard-fi-nodeadkeys:False,fcitx-keyboard-fi-smi:False,fcitx-keyboard-fi-sun_type6:False,fcitx-keyboard-fi-winkeys:False,fcitx-keyboard-fo:False,fcitx-keyboard-fo-nodeadkeys:False,fcitx-keyboard-fr:False,fcitx-keyboard-fr-afnor:False,fcitx-keyboard-fr-azerty:False,fcitx-keyboard-fr-bepo:False,fcitx-keyboard-fr-bepo_afnor:False,fcitx-keyboard-fr-bepo_latin9:False,fcitx-keyboard-fr-bre:False,fcitx-keyboard-fr-dvorak:False,fcitx-keyboard-fr-geo:False,fcitx-keyboard-fr-latin9:False,fcitx-keyboard-fr-latin9_nodeadkeys:False,fcitx-keyboard-fr-latin9_sundeadkeys:False,fcitx-keyboard-fr-mac:False,fcitx-keyboard-fr-nodeadkeys:False,fcitx-keyboard-fr-oci:False,fcitx-keyboard-fr-oss:False,fcitx-keyboard-fr-oss_latin9:False,fcitx-keyboard-fr-oss_nodeadkeys:False,fcitx-keyboard-fr-oss_sundeadkeys:False,fcitx-keyboard-fr-sun_type6:False,fcitx-keyboard-fr-sundeadkeys:False,fcitx-keyboard-fr-us:False,fcitx-keyboard-fr-us-alt:False,fcitx-keyboard-fr-us-azerty:False,fcitx-keyboard-gb:False,fcitx-keyboard-gb-colemak:False,fcitx-keyboard-gb-dvorak:False,fcitx-keyboard-gb-dvorakukp:False,fcitx-keyboard-gb-extd:False,fcitx-keyboard-gb-intl:False,fcitx-keyboard-gb-mac:False,fcitx-keyboard-gb-mac_intl:False,fcitx-keyboard-gb-pl:False,fcitx-keyboard-gb-sun_type6:False,fcitx-keyboard-ge:False,fcitx-keyboard-ge-ergonomic:False,fcitx-keyboard-ge-mess:False,fcitx-keyboard-ge-os:False,fcitx-keyboard-ge-ru:False,fcitx-keyboard-gh:False,fcitx-keyboard-gh-akan:False,fcitx-keyboard-gh-avn:False,fcitx-keyboard-gh-ewe:False,fcitx-keyboard-gh-fula:False,fcitx-keyboard-gh-ga:False,fcitx-keyboard-gh-generic:False,fcitx-keyboard-gh-gillbt:False,fcitx-keyboard-gh-hausa:False,fcitx-keyboard-gn:False,fcitx-keyboard-gr:False,fcitx-keyboard-gr-colemak:False,fcitx-keyboard-gr-extended:False,fcitx-keyboard-gr-nodeadkeys:False,fcitx-keyboard-gr-polytonic:False,fcitx-keyboard-gr-simple:False,fcitx-keyboard-gr-sun_type6:False,fcitx-keyboard-hr:False,fcitx-keyboard-hr-alternatequotes:False,fcitx-keyboard-hr-unicode:False,fcitx-keyboard-hr-unicodeus:False,fcitx-keyboard-hr-us:False,fcitx-keyboard-hu:False,fcitx-keyboard-hu-101_qwerty_comma_dead:False,fcitx-keyboard-hu-101_qwerty_comma_nodead:False,fcitx-keyboard-hu-101_qwerty_dot_dead:False,fcitx-keyboard-hu-101_qwerty_dot_nodead:False,fcitx-keyboard-hu-101_qwertz_comma_dead:False,fcitx-keyboard-hu-101_qwertz_comma_nodead:False,fcitx-keyboard-hu-101_qwertz_dot_dead:False,fcitx-keyboard-hu-101_qwertz_dot_nodead:False,fcitx-keyboard-hu-102_qwerty_comma_dead:False,fcitx-keyboard-hu-102_qwerty_comma_nodead:False,fcitx-keyboard-hu-102_qwerty_dot_dead:False,fcitx-keyboard-hu-102_qwerty_dot_nodead:False,fcitx-keyboard-hu-102_qwertz_comma_dead:False,fcitx-keyboard-hu-102_qwertz_comma_nodead:False,fcitx-keyboard-hu-102_qwertz_dot_dead:False,fcitx-keyboard-hu-102_qwertz_dot_nodead:False,fcitx-keyboard-hu-nodeadkeys:False,fcitx-keyboard-hu-oldhun:False,fcitx-keyboard-hu-qwerty:False,fcitx-keyboard-hu-standard:False,fcitx-keyboard-id:False,fcitx-keyboard-id-phoneticx:False,fcitx-keyboard-ie:False,fcitx-keyboard-ie-CloGaelach:False,fcitx-keyboard-ie-UnicodeExpert:False,fcitx-keyboard-ie-ogam:False,fcitx-keyboard-ie-ogam_is434:False,fcitx-keyboard-il:False,fcitx-keyboard-il-biblical:False,fcitx-keyboard-il-biblicalSIL:False,fcitx-keyboard-il-lyx:False,fcitx-keyboard-il-phonetic:False,fcitx-keyboard-in:False,fcitx-keyboard-in-ben:False,fcitx-keyboard-in-ben_baishakhi:False,fcitx-keyboard-in-ben_bornona:False,fcitx-keyboard-in-ben_gitanjali:False,fcitx-keyboard-in-ben_inscript:False,fcitx-keyboard-in-ben_probhat:False,fcitx-keyboard-in-bolnagri:False,fcitx-keyboard-in-eeyek:False,fcitx-keyboard-in-eng:False,fcitx-keyboard-in-guj:False,fcitx-keyboard-in-guru:False,fcitx-keyboard-in-hin-kagapa:False,fcitx-keyboard-in-hin-wx:False,fcitx-keyboard-in-jhelum:False,fcitx-keyboard-in-kan:False,fcitx-keyboard-in-kan-kagapa:False,fcitx-keyboard-in-mal:False,fcitx-keyboard-in-mal_enhanced:False,fcitx-keyboard-in-mal_lalitha:False,fcitx-keyboard-in-mar-kagapa:False,fcitx-keyboard-in-olck:False,fcitx-keyboard-in-ori:False,fcitx-keyboard-in-san-kagapa:False,fcitx-keyboard-in-tam:False,fcitx-keyboard-in-tam_tamilnet:False,fcitx-keyboard-in-tam_tamilnet_TAB:False,fcitx-keyboard-in-tam_tamilnet_TSCII:False,fcitx-keyboard-in-tam_tamilnet_with_tam_nums:False,fcitx-keyboard-in-tel:False,fcitx-keyboard-in-tel-kagapa:False,fcitx-keyboard-in-tel-sarala:False,fcitx-keyboard-in-urd-phonetic:False,fcitx-keyboard-in-urd-phonetic3:False,fcitx-keyboard-in-urd-winkeys:False,fcitx-keyboard-iq:False,fcitx-keyboard-iq-ku:False,fcitx-keyboard-iq-ku_alt:False,fcitx-keyboard-iq-ku_ara:False,fcitx-keyboard-iq-ku_f:False,fcitx-keyboard-ir:False,fcitx-keyboard-ir-ave:False,fcitx-keyboard-ir-ku:False,fcitx-keyboard-ir-ku_alt:False,fcitx-keyboard-ir-ku_ara:False,fcitx-keyboard-ir-ku_f:False,fcitx-keyboard-ir-pes_keypad:False,fcitx-keyboard-is:False,fcitx-keyboard-is-Sundeadkeys:False,fcitx-keyboard-is-dvorak:False,fcitx-keyboard-is-mac:False,fcitx-keyboard-is-mac_legacy:False,fcitx-keyboard-is-nodeadkeys:False,fcitx-keyboard-it:False,fcitx-keyboard-it-fur:False,fcitx-keyboard-it-geo:False,fcitx-keyboard-it-ibm:False,fcitx-keyboard-it-intl:False,fcitx-keyboard-it-lld:False,fcitx-keyboard-it-mac:False,fcitx-keyboard-it-nodeadkeys:False,fcitx-keyboard-it-scn:False,fcitx-keyboard-it-sun_type6:False,fcitx-keyboard-it-us:False,fcitx-keyboard-it-winkeys:False,fcitx-keyboard-jp:False,fcitx-keyboard-jp-OADG109A:False,fcitx-keyboard-jp-dvorak:False,fcitx-keyboard-jp-kana:False,fcitx-keyboard-jp-kana86:False,fcitx-keyboard-jp-mac:False,fcitx-keyboard-jp-sun_type6:False,fcitx-keyboard-jp-sun_type7:False,fcitx-keyboard-jp-sun_type7_suncompat:False,fcitx-keyboard-jv:False,fcitx-keyboard-ke:False,fcitx-keyboard-ke-kik:False,fcitx-keyboard-kg:False,fcitx-keyboard-kg-phonetic:False,fcitx-keyboard-kh:False,fcitx-keyboard-kr:False,fcitx-keyboard-kr-kr104:False,fcitx-keyboard-kr-sun_type6:False,fcitx-keyboard-kz:False,fcitx-keyboard-kz-ext:False,fcitx-keyboard-kz-kazrus:False,fcitx-keyboard-kz-latin:False,fcitx-keyboard-kz-ruskaz:False,fcitx-keyboard-la:False,fcitx-keyboard-la-stea:False,fcitx-keyboard-latam:False,fcitx-keyboard-latam-colemak:False,fcitx-keyboard-latam-colemak-gaming:False,fcitx-keyboard-latam-deadtilde:False,fcitx-keyboard-latam-dvorak:False,fcitx-keyboard-latam-nodeadkeys:False,fcitx-keyboard-latam-sundeadkeys:False,fcitx-keyboard-lk:False,fcitx-keyboard-lk-tam_TAB:False,fcitx-keyboard-lk-tam_unicode:False,fcitx-keyboard-lk-us:False,fcitx-keyboard-lt:False,fcitx-keyboard-lt-ibm:False,fcitx-keyboard-lt-lekp:False,fcitx-keyboard-lt-lekpa:False,fcitx-keyboard-lt-sgs:False,fcitx-keyboard-lt-std:False,fcitx-keyboard-lt-sun_type6:False,fcitx-keyboard-lt-us:False,fcitx-keyboard-lt-us_dvorak:False,fcitx-keyboard-lv:False,fcitx-keyboard-lv-adapted:False,fcitx-keyboard-lv-apostrophe:False,fcitx-keyboard-lv-apostrophecolemak:False,fcitx-keyboard-lv-colemak:False,fcitx-keyboard-lv-dvorak:False,fcitx-keyboard-lv-dvorakprogr:False,fcitx-keyboard-lv-ergonomic:False,fcitx-keyboard-lv-fkey:False,fcitx-keyboard-lv-minuskeydvorak:False,fcitx-keyboard-lv-minuskeydvorakprogr:False,fcitx-keyboard-lv-modern:False,fcitx-keyboard-lv-sun_type6:False,fcitx-keyboard-lv-tilde:False,fcitx-keyboard-lv-ykeydvorak:False,fcitx-keyboard-lv-ykeydvorakprogr:False,fcitx-keyboard-ma:False,fcitx-keyboard-ma-french:False,fcitx-keyboard-ma-tifinagh:False,fcitx-keyboard-ma-tifinagh-alt:False,fcitx-keyboard-ma-tifinagh-alt-phonetic:False,fcitx-keyboard-ma-tifinagh-extended:False,fcitx-keyboard-ma-tifinagh-extended-phonetic:False,fcitx-keyboard-ma-tifinagh-phonetic:False,fcitx-keyboard-mao:False,fcitx-keyboard-md:False,fcitx-keyboard-md-gag:False,fcitx-keyboard-me:False,fcitx-keyboard-me-cyrillic:False,fcitx-keyboard-me-cyrillicalternatequotes:False,fcitx-keyboard-me-cyrillicyz:False,fcitx-keyboard-me-latinalternatequotes:False,fcitx-keyboard-me-latinunicode:False,fcitx-keyboard-me-latinunicodeyz:False,fcitx-keyboard-me-latinyz:False,fcitx-keyboard-mk:False,fcitx-keyboard-mk-nodeadkeys:False,fcitx-keyboard-ml:False,fcitx-keyboard-ml-fr-oss:False,fcitx-keyboard-ml-us-intl:False,fcitx-keyboard-ml-us-mac:False,fcitx-keyboard-mm:False,fcitx-keyboard-mm-zawgyi:False,fcitx-keyboard-mn:False,fcitx-keyboard-mt:False,fcitx-keyboard-mt-alt-gb:False,fcitx-keyboard-mt-alt-us:False,fcitx-keyboard-mt-us:False,fcitx-keyboard-mv:False,fcitx-keyboard-my:False,fcitx-keyboard-my-phonetic:False,fcitx-keyboard-nec_vndr/jp:False,fcitx-keyboard-ng:False,fcitx-keyboard-ng-hausa:False,fcitx-keyboard-ng-igbo:False,fcitx-keyboard-ng-yoruba:False,fcitx-keyboard-nl:False,fcitx-keyboard-nl-mac:False,fcitx-keyboard-nl-std:False,fcitx-keyboard-nl-sun_type6:False,fcitx-keyboard-nl-sundeadkeys:False,fcitx-keyboard-no:False,fcitx-keyboard-no-colemak:False,fcitx-keyboard-no-dvorak:False,fcitx-keyboard-no-mac:False,fcitx-keyboard-no-mac_nodeadkeys:False,fcitx-keyboard-no-nodeadkeys:False,fcitx-keyboard-no-smi:False,fcitx-keyboard-no-smi_nodeadkeys:False,fcitx-keyboard-no-sun_type6:False,fcitx-keyboard-no-winkeys:False,fcitx-keyboard-np:False,fcitx-keyboard-ph:False,fcitx-keyboard-ph-capewell-dvorak:False,fcitx-keyboard-ph-capewell-dvorak-bay:False,fcitx-keyboard-ph-capewell-qwerf2k6:False,fcitx-keyboard-ph-capewell-qwerf2k6-bay:False,fcitx-keyboard-ph-colemak:False,fcitx-keyboard-ph-colemak-bay:False,fcitx-keyboard-ph-dvorak:False,fcitx-keyboard-ph-dvorak-bay:False,fcitx-keyboard-ph-qwerty-bay:False,fcitx-keyboard-pk:False,fcitx-keyboard-pk-ara:False,fcitx-keyboard-pk-snd:False,fcitx-keyboard-pk-urd-crulp:False,fcitx-keyboard-pk-urd-nla:False,fcitx-keyboard-pl:False,fcitx-keyboard-pl-colemak:False,fcitx-keyboard-pl-csb:False,fcitx-keyboard-pl-dvorak:False,fcitx-keyboard-pl-dvorak_altquotes:False,fcitx-keyboard-pl-dvorak_quotes:False,fcitx-keyboard-pl-dvp:False,fcitx-keyboard-pl-glagolica:False,fcitx-keyboard-pl-intl:False,fcitx-keyboard-pl-legacy:False,fcitx-keyboard-pl-qwertz:False,fcitx-keyboard-pl-ru_phonetic_dvorak:False,fcitx-keyboard-pl-sun_type6:False,fcitx-keyboard-pl-szl:False,fcitx-keyboard-pt:False,fcitx-keyboard-pt-colemak:False,fcitx-keyboard-pt-mac:False,fcitx-keyboard-pt-mac_nodeadkeys:False,fcitx-keyboard-pt-mac_sundeadkeys:False,fcitx-keyboard-pt-nativo:False,fcitx-keyboard-pt-nativo-epo:False,fcitx-keyboard-pt-nativo-us:False,fcitx-keyboard-pt-nodeadkeys:False,fcitx-keyboard-pt-sun_type6:False,fcitx-keyboard-pt-sundeadkeys:False,fcitx-keyboard-ro:False,fcitx-keyboard-ro-cedilla:False,fcitx-keyboard-ro-crh_dobruja:False,fcitx-keyboard-ro-ergonomic:False,fcitx-keyboard-ro-std:False,fcitx-keyboard-ro-std_cedilla:False,fcitx-keyboard-ro-sun_type6:False,fcitx-keyboard-ro-winkeys:False,fcitx-keyboard-rs:False,fcitx-keyboard-rs-alternatequotes:False,fcitx-keyboard-rs-combiningkeys:False,fcitx-keyboard-rs-latin:False,fcitx-keyboard-rs-latinalternatequotes:False,fcitx-keyboard-rs-latinunicode:False,fcitx-keyboard-rs-latinunicodeyz:False,fcitx-keyboard-rs-latinyz:False,fcitx-keyboard-rs-rue:False,fcitx-keyboard-rs-yz:False,fcitx-keyboard-ru:False,fcitx-keyboard-ru-bak:False,fcitx-keyboard-ru-chm:False,fcitx-keyboard-ru-chu:False,fcitx-keyboard-ru-cv:False,fcitx-keyboard-ru-cv_latin:False,fcitx-keyboard-ru-dos:False,fcitx-keyboard-ru-kom:False,fcitx-keyboard-ru-legacy:False,fcitx-keyboard-ru-mac:False,fcitx-keyboard-ru-os_legacy:False,fcitx-keyboard-ru-os_winkeys:False,fcitx-keyboard-ru-phonetic:False,fcitx-keyboard-ru-phonetic_azerty:False,fcitx-keyboard-ru-phonetic_dvorak:False,fcitx-keyboard-ru-phonetic_fr:False,fcitx-keyboard-ru-phonetic_mac:False,fcitx-keyboard-ru-phonetic_winkeys:False,fcitx-keyboard-ru-phonetic_yazherty:False,fcitx-keyboard-ru-prxn:False,fcitx-keyboard-ru-rulemak:False,fcitx-keyboard-ru-ruu:False,fcitx-keyboard-ru-sah:False,fcitx-keyboard-ru-srp:False,fcitx-keyboard-ru-sun_type6:False,fcitx-keyboard-ru-tt:False,fcitx-keyboard-ru-typewriter:False,fcitx-keyboard-ru-typewriter-legacy:False,fcitx-keyboard-ru-udm:False,fcitx-keyboard-ru-unipunct:False,fcitx-keyboard-ru-xal:False,fcitx-keyboard-se:False,fcitx-keyboard-se-dvorak:False,fcitx-keyboard-se-dvorak_a5:False,fcitx-keyboard-se-mac:False,fcitx-keyboard-se-nodeadkeys:False,fcitx-keyboard-se-ovd:False,fcitx-keyboard-se-rus:False,fcitx-keyboard-se-rus_nodeadkeys:False,fcitx-keyboard-se-smi:False,fcitx-keyboard-se-sun_type6:False,fcitx-keyboard-se-svdvorak:False,fcitx-keyboard-se-swl:False,fcitx-keyboard-se-us:False,fcitx-keyboard-se-us_dvorak:False,fcitx-keyboard-si:False,fcitx-keyboard-si-alternatequotes:False,fcitx-keyboard-si-us:False,fcitx-keyboard-sk:False,fcitx-keyboard-sk-acc:False,fcitx-keyboard-sk-bksl:False,fcitx-keyboard-sk-qwerty:False,fcitx-keyboard-sk-qwerty_bksl:False,fcitx-keyboard-sk-sun_type6:False,fcitx-keyboard-sn:False,fcitx-keyboard-sy:False,fcitx-keyboard-sy-ku:False,fcitx-keyboard-sy-ku_alt:False,fcitx-keyboard-sy-ku_f:False,fcitx-keyboard-sy-syc:False,fcitx-keyboard-sy-syc_phonetic:False,fcitx-keyboard-tg:False,fcitx-keyboard-th:False,fcitx-keyboard-th-pat:False,fcitx-keyboard-th-tis:False,fcitx-keyboard-tj:False,fcitx-keyboard-tj-legacy:False,fcitx-keyboard-tm:False,fcitx-keyboard-tm-alt:False,fcitx-keyboard-tr:False,fcitx-keyboard-tr-alt:False,fcitx-keyboard-tr-crh:False,fcitx-keyboard-tr-crh_alt:False,fcitx-keyboard-tr-crh_f:False,fcitx-keyboard-tr-f:False,fcitx-keyboard-tr-intl:False,fcitx-keyboard-tr-ku:False,fcitx-keyboard-tr-ku_alt:False,fcitx-keyboard-tr-ku_f:False,fcitx-keyboard-tr-sun_type6:False,fcitx-keyboard-tr-sundeadkeys:False,fcitx-keyboard-trans:False,fcitx-keyboard-tw:False,fcitx-keyboard-tw-indigenous:False,fcitx-keyboard-tw-saisiyat:False,fcitx-keyboard-tz:False,fcitx-keyboard-ua:False,fcitx-keyboard-ua-homophonic:False,fcitx-keyboard-ua-legacy:False,fcitx-keyboard-ua-phonetic:False,fcitx-keyboard-ua-rstu:False,fcitx-keyboard-ua-rstu_ru:False,fcitx-keyboard-ua-sun_type6:False,fcitx-keyboard-ua-typewriter:False,fcitx-keyboard-ua-winkeys:False,fcitx-keyboard-us-3l:False,fcitx-keyboard-us-3l-cros:False,fcitx-keyboard-us-alt-intl:False,fcitx-keyboard-us-alt-intl-unicode:False,fcitx-keyboard-us-altgr-intl:False,fcitx-keyboard-us-ats:False,fcitx-keyboard-us-carpalx:False,fcitx-keyboard-us-carpalx-altgr-intl:False,fcitx-keyboard-us-carpalx-full:False,fcitx-keyboard-us-carpalx-full-altgr-intl:False,fcitx-keyboard-us-carpalx-full-intl:False,fcitx-keyboard-us-carpalx-intl:False,fcitx-keyboard-us-chr:False,fcitx-keyboard-us-colemak:False,fcitx-keyboard-us-crd:False,fcitx-keyboard-us-cz_sk_de:False,fcitx-keyboard-us-de_se_fi:False,fcitx-keyboard-us-drix:False,fcitx-keyboard-us-dvorak:False,fcitx-keyboard-us-dvorak-alt-intl:False,fcitx-keyboard-us-dvorak-classic:False,fcitx-keyboard-us-dvorak-intl:False,fcitx-keyboard-us-dvorak-l:False,fcitx-keyboard-us-dvorak-r:False,fcitx-keyboard-us-dvp:False,fcitx-keyboard-us-euro:False,fcitx-keyboard-us-hbs:False,fcitx-keyboard-us-ibm238l:False,fcitx-keyboard-us-intl:False,fcitx-keyboard-us-intl-unicode:False,fcitx-keyboard-us-mac:False,fcitx-keyboard-us-norman:False,fcitx-keyboard-us-olpc2:False,fcitx-keyboard-us-rus:False,fcitx-keyboard-us-scn:False,fcitx-keyboard-us-sun_type6:False,fcitx-keyboard-us-workman:False,fcitx-keyboard-us-workman-intl:False,fcitx-keyboard-uz:False,fcitx-keyboard-uz-latin:False,fcitx-keyboard-vn:False,fcitx-keyboard-vn-aderty:False,fcitx-keyboard-vn-fr:False,fcitx-keyboard-vn-qderty:False,fcitx-keyboard-vn-us:False,fcitx-keyboard-za:False' ~/.config/fcitx/profile
	echo "TheInputMethod=1" >> $CONFIG
	
	cat <<-EOF>> ~/.bashrc
	if [ "\$TERM"="linux" ] ;then 
		#export LANGUAGE=en_US 
		echo ""
	fi 
	EOF
	
	cd ~/.config/xfce4/panel/launcher-18/
	cat<<-EOF > `ls`
	[Desktop Entry]
	Version=1.0
	Name=ubuntu
	StartupNotify=true
	OnlyShowIn=XFCE;
	X-AppStream-Ignore=True
	Exec=/usr/local/bin/ubuntu
	Terminal=true
	X-MultipleArgs=false
	Type=Application
	Icon=$HOME/.icons/ubuntu-logo-icon.png
	EOF
	cd ~
		
}



if [ ! -e $CONFIG  ];then

	_xfce
	_DPI
	export LC_ALL=""
	##设置面板图标
	mkdir -p ~/.icons
	wget https://raw.githubusercontent.com/WindowHZT/termux-ubuntu2004/main/mix/ubuntu-logo-icon.png -O ~/.icons/ubuntu-logo-icon.png
	sudo service dbus start
	_start
	
	##设置状态栏图标
	xfconf-query -c xfce4-panel -np '/plugins/plugin-1/button-icon' -t 'string' -s '/home/hzt/.icons/ubuntu-logo-icon.png'
	##设置状态栏大小
	xfconf-query -c xfce4-panel -np '/panels/panel-1/icon-size' -t 'int' -s 20
	##设置plank面板图标大小
	xfconf-query -c xfce4-panel -np '/panels/panel-2/size' -t 'int' -s 100
	##设置字体大小
	xfconf-query -c xsettings -np '/Xft/DPI' -t 'int' -s 200
	##设置桌面图标大小
	xfconf-query -c xfce4-desktop -np '/desktop-icons/icon-size' -t 'int' -s 100
	
	startTime=`cat /data/data/com.termux/files/home/Time`
	rm -rf /data/data/com.termux/files/home/Time
	endTime=`date +"%Y-%m-%d %H:%M:%S"`
	st=`date -d  "$startTime" +%s`
	et=`date -d  "$endTime" +%s`
	sumTime=$(($et-$st))
	
	echo -e "\n\n\t安装ubuntu20.04总耗时 : $sumTime second."
	exit
fi


case $1 in
	"start")  ##启动vnc
		_start
		;;
	"stop")  ##停止vnc
		_stop
		;;
	"changeDPI")  ##改变vnc分辨率
		_DPI
		;;
	"changePWD")  ##改变vnc密码
		_PWD
		;;
	*)
		echo -e "\tvnc 帮助文档"
		echo -e "\t(1)使用命令 vnc start 启动vnc服务"
		echo -e "\t(2)使用命令 vnc stop 停止vnc服务"
		echo -e "\t(3)使用命令 vnc changeDPI 更改vnc分辨率"
		echo -e "\t(4)使用命令 vnc changePWD 更改vnc密码"
		;;
esac